(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42d21074"],{"41d0":function(t,e,s){},6464:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return r}));var a=s("5c96"),n=function(t,e,s,n){return Object(a["Notification"])({title:e,message:s,type:t,showClose:n})},r=function(t,e){return Object(a["Message"])({type:t,message:e})}},b7a5:function(t,e,s){"use strict";s("41d0")},c937:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scroll-container"},[s("el-scrollbar",{staticClass:"app-container",attrs:{vertical:"true",native:!1,"view-style":"{width:100%; height:100%;}"}},[s("el-alert",{attrs:{type:"info"}},[t._v(" 只顯示今天的訂單，拖曳改變訂單狀態，點一下訂單可以修改內容，或進行[暫存]/[結帳] ")]),s("el-row",{staticClass:"row-container",attrs:{type:"flex"}},t._l(t.statusList,(function(e,a){return s("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.loading[a],expression:"loading[index]"}],key:e.id,staticClass:"col-container",class:e.className,attrs:{span:8}},[s("el-row",{attrs:{gutter:5,type:"flex",justify:"center",align:"middle"}},[s("el-col",{attrs:{span:18}},[s("h2",[s("i",{class:e.icon}),t._v(" "+t._s(e.name))])]),s("el-col",{staticClass:"align-right",attrs:{span:6}},[s("el-button",{attrs:{icon:"fas el-icon-fa-sync"},on:{click:t.initOrderStatusDetail}})],1)],1),s("draggable",{staticClass:"list-group",class:e.className,attrs:{list:e.children,draggable:".item","empty-insert-threshold":500,"ghost-class":"ghost",group:"dashboard",move:t.checkMoveCondition},on:{change:function(s){return t.onChangeOrder(e.id,s)}}},t._l(e.children,(function(e,a){return s("el-card",{key:a,staticClass:"item-card item",class:{takeout:e.desk>0}},[s("template",{slot:"header"},[s("el-row",[s("el-col",{directives:[{name:"touch",rawName:"v-touch:tap",value:function(){return t.toEditOrder(e.id)},expression:"()=>toEditOrder(item.id)",arg:"tap"}],attrs:{span:18}},[s("span",{staticClass:"number"},[t._v(t._s(e.orderID))]),t._v(" "+t._s(e.customer.name)+" ")]),s("el-col",{staticClass:"align-right",attrs:{span:6}},[t._v(" 結帳 "),s("el-switch",{attrs:{disabled:""},model:{value:e.checkOut,callback:function(s){t.$set(e,"checkOut",s)},expression:"item.checkOut"}})],1)],1)],1),s("el-row",{attrs:{gutter:10}},[s("el-col",{staticClass:"align-right",attrs:{span:5}},[t._v(" 桌號 ")]),s("el-col",{attrs:{span:9}},[s("span",{staticClass:"desk"},[s("b",[t._v(t._s(0===e.desk?"外帶":e.desk))])])]),s("el-col",{staticClass:"align-right",attrs:{span:5}},[t._v(" 訂單來源 ")]),s("el-col",{attrs:{span:5}},[t._v(" "+t._s(e.orderFrom)+" ")])],1),s("el-divider"),t._l(e.orderDetails,(function(e,a){return s("el-row",{key:a,staticClass:"orderDetail",attrs:{gutter:10}},[s("el-col",{staticClass:"count align-right",attrs:{span:4}},[t._v(" "+t._s(e.count)+" ")]),s("el-col",{attrs:{span:20}},[s("el-row",[s("el-col",[e.cook?s("el-tag",{attrs:{type:e.cook.className,size:"large",effect:"dark"}},[t._v(" "+t._s(e.cook.label)+" ")]):t._e(),s("b",[t._v(t._s(e.transactionItem))]),s("div",{staticClass:"align-right"},[t._v("$"+t._s(Math.round(e.transactionCost)))])],1),e.menuItem.menuSet?s("el-col",t._l(e.menuItem.menuSet,(function(e,a){return s("el-tag",{key:a},[t._v(" "+t._s(e.name)+" ")])})),1):t._e(),e.remark?s("el-col",[t._v(" **"+t._s(e.remark)+" ")]):t._e()],1)],1)],1)})),s("el-row",[e.checkOut?[s("el-col",{attrs:{span:8}},[t._v("總計")]),s("el-col",{staticClass:"align-right",attrs:{span:16}},[s("b",[t._v("$"+t._s(e.checkOutTotal))])])]:[s("el-col",{attrs:{span:8}},[t._v("未結帳金額")]),s("el-col",{staticClass:"align-right",attrs:{span:16}},[s("b",[t._v("$"+t._s(t.tempTotal(e.orderDetails)))])])]],2)],2)})),1)],1)})),1)],1)],1)},n=[],r=s("5530"),i=(s("159b"),s("d3b7"),s("c740"),s("1276"),s("ac1f"),s("13d5"),s("2f62")),c=s("1980"),l=s.n(c),o=s("4ec3"),u=s("6464"),d={name:"Dashboard",components:{draggable:l.a},data:function(){return{currentRole:"adminDashboard",statusList:[],loading:[]}},computed:Object(r["a"])({},Object(i["b"])(["roles"])),mounted:function(){this.getOrderStatus()},methods:{getOrderStatus:function(){var t=this;Object(o["F"])("").then((function(e){t.statusList=e.data.result,t.initOrderStatusDetail()}))},initOrderStatusDetail:function(){var t=this;this.statusList.forEach((function(e,s){t.getOrderStatusDetail(e.id,s)}))},getOrderStatusDetail:function(t,e){var s=this;this.$set(this.loading,e,!0),Object(o["C"])("?status="+t).then((function(e){var a=s.statusList.findIndex((function(e){return e.id===t}));s.$set(s.statusList[a],"children",e.data.result)})).finally((function(){s.$set(s.loading,e,!1)}))},checkMoveCondition:function(t){var e=t.to,s=t.from,a=this.statusList.findIndex((function(t){return t.className===e.className.split(" ")[e.className.split(" ").length-1]})),n=this.statusList.findIndex((function(t){return t.className===s.className.split(" ")[s.className.split(" ").length-1]}));if(Math.abs(n-a)>1)return!1},onChangeOrder:function(t,e){var s=this;if(e["added"]){var a=Object(o["M"])(e.added.element.id,{status:t}).then((function(t){return s.initOrderStatusDetail(),Object(u["a"])("success","狀態變更",t.data.orderID+" 訂單狀態變更成功",!1),Promise.resolve(!0)})).catch((function(t){return Object(u["a"])("error","Error",t,!1),Promise.reject(!1)}));return a.then((function(t){return t}))}},toEditOrder:function(t){this.$router.push({name:"EditOrder",params:{id:t}})},tempTotal:function(t){return t.length<=0?0:t.reduce((function(t,e){return e.count*e.transactionCost+t}),0)}}},h=d,f=(s("b7a5"),s("2877")),g=Object(f["a"])(h,a,n,!1,null,"5d83af04",null);e["default"]=g.exports}}]);