(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e354720"],{"4c53":function(e,t,a){"use strict";var r=a("23e7"),n=a("857a"),s=a("af03");r({target:"String",proto:!0,forced:s("sub")},{sub:function(){return n(this,"sub","","")}})},"54cd":function(e,t,a){},"857a":function(e,t,a){var r=a("1d80"),n=/"/g;e.exports=function(e,t,a,s){var i=String(r(e)),c="<"+t;return""!==a&&(c+=" "+a+'="'+String(s).replace(n,"&quot;")+'"'),c+">"+i+"</"+t+">"}},af03:function(e,t,a){var r=a("d039");e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},c0c2:function(e,t,a){"use strict";a("54cd")},d028:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("splitpanes",{ref:"mainSplit"},[a("pane",{attrs:{size:e.splitSize[0]}},[a("div",{staticClass:"split-container"},[a("h2",[e._v("分類")]),a("TableView",{ref:"main",staticClass:"table",attrs:{data:e.data,"column-options":e.columnOptions[0],form:e.formBody[0],rules:e.rules[0],"table-options":{isCanSelection:!0},page:e.page[0],"page-size":e.pageSize[0],target:0,loading:e.loading[0]},on:{search:e.getDataset,refresh:e.getDataset,delete:e.deleteDataset,create:e.createDataset,edit:e.editDataset,"select-row":e.onSelectRow,"size-change":e.handlePageSizeChange,"page-change":e.handlePageChange}})],1)]),a("pane",{attrs:{size:e.splitSize[1]}},[e.selectRow&&Object.keys(e.selectRow).length>0?a("div",{staticClass:"split-container"},[a("h2",[e._v(e._s(e.selectRow.name)+" 原料")]),a("TableView",{ref:"sub",staticClass:"table",attrs:{data:e.subData,"column-options":e.columnOptions[1],form:e.formBody[1],"table-options":{isCanSelection:!0},page:e.page[1],"page-size":e.pageSize[1],rules:e.rules[1],target:1,"target-object":{label:e.selectRow},loading:e.loading[1]},on:{search:function(t){return e.getSubDataset(e.selectRow.id,t)},refresh:function(t){return e.getSubDataset(e.selectRow.id)},delete:e.deleteSubDataset,create:e.createSubDataset,edit:e.editSubDataset,"select-row":e.onSelectSubRow,"size-change":e.handlePageSizeChange,"page-change":e.handlePageChange}})],1):e._e()]),a("pane",{attrs:{size:e.splitSize[2]}},[e.selectSubRow&&Object.keys(e.selectSubRow).length>0?a("div",{staticClass:"container"},[a("h2",[e._v(e._s(e.selectSubRow.name)+" 庫存紀錄")]),a("TableView",{ref:"inner",staticClass:"table",attrs:{data:e.innerData,"column-options":e.columnOptions[2],form:e.formBody[2],page:e.page[2],"page-size":e.pageSize[2],target:2,"target-object":{material:e.selectSubRow},rules:e.rules[2],loading:e.loading[2]},on:{search:function(t){return e.getInnerDataset(e.selectSubRow.id,t)},refresh:function(t){return e.getInnerDataset(e.selectSubRow.id)},delete:e.deleteInnerDataset,create:e.createInnerDataset,edit:e.editInnerDataset,"size-change":e.handlePageSizeChange,"page-change":e.handlePageChange}})],1):e._e()])],1)],1)},n=[],s=(a("d3b7"),a("4c53"),a("4ec3")),i=a("512e"),c=a("0253"),o=a("6464"),l={name:"Menu",components:{Splitpanes:i["Splitpanes"],Pane:i["Pane"],TableView:c["a"]},data:function(){return{loading:[!1,!1,!1],page:[1,1,1],pageSize:[10,10,10],splitSize:[50,50,0],data:[],selectRow:{},subData:[],selectSubRow:{},innerData:[]}},computed:{formBody:function(){return[[{label:"分類名稱",field:"name",type:"text",inputType:"el-input"}],[{label:"分類",field:"label",type:"text",inputType:"el-select",dataset:this.getLabelSelection,options:{filterable:!0}},{label:"名稱",field:"name",type:"text",inputType:"el-input"},{label:"品牌名稱",field:"brand",type:"text",inputType:"el-input"},{label:"單位",field:"unit",type:"text",inputType:"el-select",dataset:this.getUnitSelection,options:{filterable:!0}}],[{label:"進貨時間",field:"stockDate",type:"date",inputType:"el-date-picker",options:{"value-format":"yyyy-MM-dd"}},{label:"有效期限",field:"expiryDate",type:"date",inputType:"el-date-picker",options:{"value-format":"yyyy-MM-dd"}},{label:"原料",field:"material",type:"text",inputType:"el-select",dataset:this.getMaterialSelection},{label:"庫存",field:"stock",type:"decimal",inputType:"el-input-number"}]]},columnOptions:function(){return[[{label:"ID",field:"id"},{label:"分類名稱",field:"name"}],[{label:"ID",field:"id"},{label:"分類",field:"label.name"},{label:"名稱",field:"name"},{label:"品牌名稱",field:"brand"},{label:"單位",field:"unit.sign"}],[{label:"進貨時間",field:"stockDate"},{label:"有效期限",field:"expiryDate"},{label:"原料",field:"material"},{label:"庫存",field:"stock"}]]},rules:function(){return[{name:[{required:!0,message:"必填欄位",trigger:"blur"}]},{name:[{required:!0,message:"必填欄位",trigger:"blur"}],label:[{required:!0,message:"必填欄位",trigger:"blur"}],brand:[{required:!0,message:"必填欄位",trigger:"blur"}],unit:[{required:!0,message:"必填欄位",trigger:"blur"}]},{stockDate:[{required:!0,message:"必填欄位",trigger:"blur"}],expiryDate:[{required:!0,message:"必填欄位",trigger:"blur"}],material:[{required:!0,message:"必填欄位",trigger:"blur"}],stock:[{required:!0,message:"必填欄位",trigger:"blur"}]}]}},mounted:function(){this.getDataset()},methods:{getDataset:function(e){var t=this;this.$set(this.loading,0,!0);var a="?page="+this.page[0]+"&page_size="+this.pageSize[0];e&&(a+="&search="+e),Object(s["v"])(a).then((function(e){t.data=e.data,t.$refs["main"].createDialog=!1,t.$refs["main"].formBody={},t.$refs["main"].editItem={}})).catch((function(e){Object(o["a"])("error","Error",e,!1)})).finally((function(){t.$set(t.loading,0,!1)}))},getLabelSelection:function(){return Object(s["v"])("?selection=name").then((function(e){return Promise.resolve(e.data)})).catch((function(e){return Object(o["a"])("error","Error",e,!1),Promise.reject()}))},getUnitSelection:function(){return Object(s["J"])("?selection=sign").then((function(e){return Promise.resolve(e.data)})).catch((function(e){return Object(o["a"])("error","Error",e,!1),Promise.reject()}))},getMaterialSelection:function(){return Object(s["w"])("?selection=name").then((function(e){return Promise.resolve(e.data)})).catch((function(e){return Object(o["a"])("error","Error",e,!1),Promise.reject()}))},deleteDataset:function(e){var t=this;Object(s["f"])(e.id).then((function(e){Object(o["a"])("success","Delete Success",e.data,!1),t.getDataset()})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},createDataset:function(e){var t=this;Object(s["P"])(e).then((function(e){Object(o["a"])("success","Create Success",e.data,!1),t.$refs["main"].createDialog=!1,t.$refs["main"].formBody={},t.$refs["main"].editItem={},t.getDataset()})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},editDataset:function(e){var t=this;Object(s["bb"])(e.id,e.data).then((function(e){Object(o["a"])("success","Edit Success",e.data,!1),t.$refs["main"].createDialog=!1,t.$refs["main"].formBody={},t.$refs["main"].editItem={},t.getDataset()})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},onSelectRow:function(e){this.selectRow=e,e&&(this.splitSize=[50,50,0],this.getSubDataset(e.id))},getSubDataset:function(e,t){var a=this;this.$set(this.loading,1,!0);var r="?label="+e+"&page="+this.page[1]+"&page_size="+this.pageSize[1];t&&(r+="&search="+t),Object(s["w"])(r).then((function(e){a.subData=e.data})).catch((function(e){Object(o["a"])("error","Error",e,!1)})).finally((function(){a.$set(a.loading,1,!1)}))},deleteSubDataset:function(e){var t=this;Object(s["g"])(e.id).then((function(e){Object(o["a"])("success","Delete Success",e.data,!1),t.getSubDataset(t.selectRow.id)})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},createSubDataset:function(e){var t=this;Object(s["Q"])(e).then((function(e){Object(o["a"])("success","Create Success",e.data,!1),t.$refs["sub"].createDialog=!1,t.$refs["sub"].formBody={},t.$refs["sub"].editItem={},t.getSubDataset(t.selectRow.id)})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},editSubDataset:function(e){var t=this;Object(s["cb"])(e.id,e.data).then((function(e){Object(o["a"])("success","Edit Success",e.data,!1),t.$refs["sub"].createDialog=!1,t.$refs["sub"].formBody={},t.$refs["sub"].editItem={},t.getSubDataset(t.selectRow.id)})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},onSelectSubRow:function(e){this.selectSubRow=e,e&&(this.splitSize=[20,30,50],this.getInnerDataset(e.id))},getInnerDataset:function(e,t){var a=this;this.$set(this.loading,2,!0);var r="?material="+e+"&page="+this.page[2]+"&page_size="+this.pageSize[2];t&&(r+="&search="+t),Object(s["H"])(r).then((function(e){a.innerData=e.data})).catch((function(e){Object(o["a"])("error","Error",e,!1)})).finally((function(){a.$set(a.loading,2,!1)}))},getInnerFormBody:function(){var e=this;Object(s["G"])().then((function(t){e.innerFormBody=t.data})).catch((function(e){Object(o["a"])("error","Error",e,!1)}))},deleteInnerDataset:function(e){var t=this;Object(s["m"])(e.id).then((function(e){Object(o["a"])("success","Delete Success",e.data,!1),t.getInnerDataset(t.selectSubRow.id)})).catch((function(e){Object(o["a"])("error","Error",e,!1)}))},createInnerDataset:function(e){var t=this;Object(s["W"])(e).then((function(e){Object(o["a"])("success","Create Success",e.data,!1),t.$refs["inner"].createDialog=!1,t.$refs["inner"].formBody={},t.$refs["inner"].editItem={},t.getInnerDataset(t.selectSubRow.id)})).catch((function(e){Object(o["a"])("error","Error",e,!1)}))},editInnerDataset:function(e){var t=this;Object(s["jb"])(e.id,e.data).then((function(e){Object(o["a"])("success","Edit Success",e.data,!1),t.$refs["inner"].createDialog=!1,t.$refs["inner"].formBody={},t.$refs["inner"].editItem={},t.getInnerDataset(t.selectSubRow.id)})).catch((function(e){return e.response?Object(o["a"])("error","Error",e.response.data,!1):Object(o["a"])("error","Error",e,!1)}))},handlePageSizeChange:function(e){switch(this.$set(this.pageSize,e[0],e[1]),e[0]){case 0:return this.getDataset();case 1:return this.getSubDataset(this.selectRow.id);case 2:return this.getInnerDataset(this.selectSubRow.id)}},handlePageChange:function(e){switch(this.$set(this.page,e[0],e[1]),e[0]){case 0:return this.getDataset();case 1:return this.getSubDataset(this.selectRow.id);case 2:return this.getInnerDataset(this.selectSubRow.id)}}}},u=l,d=(a("c0c2"),a("2877")),b=Object(d["a"])(u,r,n,!1,null,null,null);t["default"]=b.exports}}]);