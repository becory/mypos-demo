(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d80bf6b"],{"0253":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-col",{attrs:{md:20}},[t.tableOptions["disableCreate"]?t._e():n("el-button",{attrs:{type:"primary",icon:"fas el-icon-fa-plus"},on:{click:t.onCreate}},[t._v(" 新增 ")]),n("el-input",{staticStyle:{width:"100px"},attrs:{"prefix-icon":"fas el-icon-fa-search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),n("el-col",{staticClass:"align-right",attrs:{md:4}},[n("el-button",{attrs:{type:"primary",icon:"fas el-icon-fa-sync-alt"},on:{click:t.onRefresh}})],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],key:t.reload,staticClass:"table",attrs:{data:t.data["result"],"highlight-current-row":t.tableOptions["isCanSelection"]},on:{"current-change":t.handleCurrentChange}},[t._l(t.columnOptions,(function(e,i){return n("el-table-column",{key:i,attrs:{prop:e.field,label:e.label,fixed:e.fixed},scopedSlots:t._u([{key:"default",fn:function(n){return[t._v(" "+t._s(t.formatRow(n.row,e.field))+" ")]}}],null,!0)})})),t.tableOptions["disableOperation"]?t._e():n("el-table-column",{attrs:{label:"操作",fixed:"right",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.tableOptions["disableEdit"]?t._e():n("el-button",{attrs:{type:"info",size:"small",icon:"fas el-icon-fa-edit"},on:{click:function(n){return t.onEdit(e.row)}}}),t.tableOptions["isCanUpload"]?n("el-button",{attrs:{type:"success",size:"small",icon:"fas el-icon-fa-image"},on:{click:function(n){return t.onUpload(e.row)}}}):t._e(),t.tableOptions["disableDelete"]?t._e():n("el-button",{attrs:{type:"danger",size:"small",icon:"fas el-icon-fa-trash-alt"},on:{click:function(n){return t.onDelete(e.row)}}})]}}],null,!1,706456614)})],2),n("el-pagination",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"pager",attrs:{"current-page":t.page,"page-sizes":[1,2,5,10],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.data["totalCount"]},on:{"size-change":t.handlePageSizeChange,"current-change":t.handlePageCurrentChange}}),t.tableOptions["disableCreate"]&&t.tableOptions["disableEdit"]?t._e():n("el-dialog",{attrs:{visible:t.createDialog,"append-to-body":!0,title:t.mode},on:{"update:visible":function(e){t.createDialog=e}}},[n("el-form",{ref:"form",attrs:{model:t.formBody,rules:t.rules}},[t._l(t.form,(function(e,i){return[n("el-form-item",{key:i,attrs:{label:e["label"],prop:e["field"]}},[n(e["inputType"],t._b({tag:"div",attrs:{dataset:e.dataset},model:{value:t.formBody[e.field],callback:function(n){t.$set(t.formBody,e.field,n)},expression:"formBody[input.field]"}},"div",e.options,!1),["el-select"===e["inputType"]?t._l(t.selectionOptions[e.field],(function(t,e){return n("el-option",{key:e,attrs:{label:t.value+" - "+t.label,value:t.value}})})):"el-radio-group"===e["inputType"]?t._l(e.dataset,(function(e,i){return n("el-radio",{key:i,attrs:{label:e.value}},[t._v(t._s(e.label)+" ")])})):t._e()],2),e.dataset&&"el-select"===e["inputType"]?n("el-button",{attrs:{icon:"fas el-icon-fa-sync"},on:{click:function(n){return t.getSelectionOptions(e.field,e.dataset)}}}):t._e()],1)]})),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("Submit")]),n("el-button",{on:{click:t.onReset}},[t._v("Reset")])],1)],2)],1),t.tableOptions["isCanUpload"]&&!t.tableOptions["disableOperation"]?n("el-dialog",{attrs:{visible:t.uploadModal,"append-to-body":!0,title:"上傳"},on:{"update:visible":function(e){t.uploadModal=e}}},[n("h1",[t._v(t._s(t.uploadName))]),n("el-form",[n("el-form-item",{attrs:{label:"上傳"}},[n("el-upload",{attrs:{drag:"",action:"","show-file-list":!1,"http-request":t.onUploadFile}})],1)],1)],1):t._e()],1)},o=[],a=(n("a9e3"),n("159b"),n("4de4"),n("b64b"),n("b0c0"),n("1276"),n("ac1f"),n("13d5"),n("6464")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.data.length>0?n("el-table",{attrs:{data:t.data,"show-header":!1}},[n("el-table-column",{attrs:{width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b",[t._v(t._s(e.$index+1))])]}}],null,!1,3110829868)}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-form-item",[n("el-cascader",{staticStyle:{width:"50%"},attrs:{options:t.selectionOptions,filterable:"",clearable:""},on:{change:function(n){return t.handlerChange(e.row,n)}},model:{value:e.row[t.options["combineField"]],callback:function(n){t.$set(e.row,t.options["combineField"],n)},expression:"scope.row[options['combineField']]"}}),n("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},model:{value:e.row[t.options["value"]],callback:function(n){t.$set(e.row,t.options["value"],n)},expression:"scope.row[options['value']]"}},[e.row[t.options["append"]]?n("span",{attrs:{slot:"append"},slot:"append"},[t._v(t._s(e.row[t.options["append"]]))]):t._e()])],1)]}}],null,!1,3660458182)}),n("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger",icon:"fas el-icon-fa-trash-alt"},on:{click:function(n){return t.onDelete(e.$index)}}})]}}],null,!1,1356999348)})],1):t._e(),n("el-button",{attrs:{icon:"fas el-icon-fa-plus-circle",type:"success"},on:{click:t.onAdd}}),n("el-button",{attrs:{icon:"fas el-icon-fa-sync-alt"},on:{click:t.getSelectionOptions}})],1)},s=[],r=n("ade3"),c=(n("d81d"),n("a434"),n("7db0"),{name:"ListField",model:{prop:"value",event:"input"},props:{value:{type:Array,default:function(){return[]}},dataset:{type:Function,default:function(){}},options:{type:Object,default:function(){return{}}}},data:function(){return{data:[],selectionOptions:[]}},watch:{data:function(t){this.$emit("input",t)},value:{deep:!0,handler:function(t){var e=this;this.data=t.map((function(t){return t.hasOwnProperty(e.options["combineField"])||(t[e.options["combineField"]]=[t[e.options["master"]],t[e.options["child"]]]),t})),this.data=t}}},mounted:function(){var t=this;this.data=this.value.map((function(e){return e.hasOwnProperty(t.options["combineField"])||(e[t.options["combineField"]]=[e[t.options["master"]],e[t.options["child"]]]),e})),this.getSelectionOptions()},methods:{getSelectionOptions:function(){var t=this;this.dataset().then((function(e){return t.selectionOptions=e}))},onAdd:function(){var t,e=(t={},Object(r["a"])(t,this.options["master"],null),Object(r["a"])(t,this.options["child"],null),Object(r["a"])(t,this.options["combineField"],null),Object(r["a"])(t,this.options["value"],null),t);this.options["append"]&&(e[this.options["append"]]=null),this.data.push(e)},onDelete:function(t){this.data.splice(t,1)},handlerChange:function(t,e){if(e&&e[0]&&e[1]){t[this.options["master"]]=e[0],t[this.options["child"]]=e[1];var n=this.selectionOptions.find((function(t){return t.value===e[0]}));if(n.children){var i=n.children.find((function(t){return t.value===e[1]}));this.options["append"]&&(t[this.options["append"]]=i[this.options["append"]])}}else t[this.options["append"]]=null}}}),u=c,d=(n("2095"),n("2877")),p=Object(d["a"])(u,l,s,!1,null,null,null),f=p.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.data.length>0?n("el-table",{attrs:{data:t.data,"show-header":!1}},[n("el-table-column",{attrs:{width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b",[t._v(t._s(e.$index+1))])]}}],null,!1,3110829868)}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-form-item",[n("el-cascader",{staticStyle:{width:"50%"},attrs:{options:t.selectionOptions,filterable:"",clearable:""},on:{change:function(n){return t.handlerChange(e.row,n)}},model:{value:e.row[t.options["combineField"]],callback:function(n){t.$set(e.row,t.options["combineField"],n)},expression:"scope.row[options['combineField']]"}}),n("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},model:{value:e.row[t.options["value"]],callback:function(n){t.$set(e.row,t.options["value"],n)},expression:"scope.row[options['value']]"}},[e.row[t.options["append"]]?n("span",{attrs:{slot:"append"},slot:"append"},[t._v(t._s(e.row[t.options["append"]]))]):t._e()])],1),n("el-form-item",[n("el-select",{model:{value:e.row.cook,callback:function(n){t.$set(e.row,"cook",n)},expression:"scope.row.cook"}},t._l(t.cookOptions,(function(t,e){return n("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1),n("el-input",{model:{value:e.row.remark,callback:function(n){t.$set(e.row,"remark",n)},expression:"scope.row.remark"}})],1)]}}],null,!1,1574009875)}),n("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger",icon:"fas el-icon-fa-trash-alt"},on:{click:function(n){return t.onDelete(e.$index)}}})]}}],null,!1,1356999348)})],1):t._e(),n("el-button",{attrs:{icon:"fas el-icon-fa-plus-circle",type:"success"},on:{click:t.onAdd}}),n("el-button",{attrs:{icon:"fas el-icon-fa-sync-alt"},on:{click:t.getSelectionOptions}})],1)},m=[],b=(n("d3b7"),n("4ec3")),g={name:"ListField",model:{prop:"value",event:"input"},props:{value:{type:Array,default:function(){return[]}},dataset:{type:Function,default:function(){}},options:{type:Object,default:function(){return{}}}},data:function(){return{data:[],selectionOptions:[],cookOptions:[]}},watch:{data:function(t){this.$emit("input",t)},value:{deep:!0,handler:function(t){var e=this;this.data=t.map((function(t){return t.hasOwnProperty(e.options["combineField"])||(t[e.options["combineField"]]=[t[e.options["master"]],t[e.options["child"]]]),t})),this.data=t}}},mounted:function(){var t=this;this.data=this.value.map((function(e){return e.hasOwnProperty(t.options["combineField"])||(e[t.options["combineField"]]=[e[t.options["master"]],e[t.options["child"]]]),e})),this.getSelectionOptions()},methods:{getSelectionOptions:function(){var t=this;this.dataset().then((function(e){return t.selectionOptions=e})),this.getCookSelection().then((function(e){return t.cookOptions=e}))},onAdd:function(){var t,e=(t={},Object(r["a"])(t,this.options["master"],null),Object(r["a"])(t,this.options["child"],null),Object(r["a"])(t,this.options["combineField"],null),Object(r["a"])(t,this.options["value"],null),Object(r["a"])(t,"cook",null),Object(r["a"])(t,"remark",null),t);this.options["append"]&&(e[this.options["append"]]=null),this.data.push(e)},getCookSelection:function(){return Object(b["t"])("?selection=name").then((function(t){return Promise.resolve(t.data)})).catch((function(t){return Object(a["a"])("error","Error",t,!1),Promise.reject()}))},onDelete:function(t){this.data.splice(t,1)},handlerChange:function(t,e){if(e&&e[0]&&e[1]){t[this.options["master"]]=e[0],t[this.options["child"]]=e[1];var n=this.selectionOptions.find((function(t){return t.value===e[0]}));if(n.children){var i=n.children.find((function(t){return t.value===e[1]}));this.options["append"]&&(t[this.options["append"]]=i[this.options["append"]])}}else t[this.options["append"]]=null}}},y=g,v=(n("24fe"),Object(d["a"])(y,h,m,!1,null,null,null)),O=v.exports,w={name:"Index",components:{ItemValueField:f,OrderDetailField:O},props:{data:{type:[Object,Array],default:function(){return{}}},columnOptions:{type:Array,default:function(){return[]}},form:{type:Array,default:function(){return[]}},tableOptions:{type:Object,default:function(){return{}}},page:{type:Number,default:1},pageSize:{type:Number,default:25},target:{type:Number,default:0},targetObject:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}},name:{type:String,default:null},loading:{type:Boolean,default:!1}},data:function(){return{currentPage:1,createDialog:!1,formBody:{},selectionOptions:{},editID:null,editItem:{},editing:!1,reload:984568746*Math.random(),uploadModal:!1,uploadName:"",search:""}},computed:{mode:function(){return this.editing?"編輯":"建立"},api:function(){return"https://mypos-demo.herokuapp.com/api/"}},watch:{columnOptions:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.reload=e.reload+1}))}},search:function(t){this.$emit("search",t)}},mounted:function(){var t=this;this.form.filter((function(t){return t["dataset"]})).forEach((function(e){"function"===typeof e.dataset&&t.getSelectionOptions(e.field,e.dataset)}))},methods:{getSelectionOptions:function(t,e){var n=this;e().then((function(e){return n.$set(n.selectionOptions,t,e)})).catch((function(t){return Object(a["b"])("error",t)}))},onCreate:function(){var t=this;if(this.formBody={},Object.keys(this.targetObject).length>0){var e={};Object.keys(this.targetObject).forEach((function(n){e[n]=t.targetObject[n].id})),this.formBody=Object.assign(this.formBody,e)}this.editItem={},this.editID=null,this.editing=!1,this.createDialog=!0},onRefresh:function(){this.$emit("refresh")},onEdit:function(t){var e=this;if(this.formBody=JSON.parse(JSON.stringify(t)),Object.keys(this.targetObject).length>0){var n={};Object.keys(this.targetObject).forEach((function(t){n[t]=e.targetObject[t].id})),this.formBody=Object.assign(this.formBody,n)}this.editItem=JSON.parse(JSON.stringify(t)),this.editID=t.id,this.editing=!0,this.createDialog=!0},onUpload:function(t){this.uploadModal=!0,this.editID=t.id,this.uploadName=t.name},onUploadFile:function(t){var e=this,n=new FormData;n.append("image",t.file);var i=b["c"];i.put(this.name+this.editID+"/Upload/",n).then((function(t){e.$emit("refresh"),Object(a["a"])("success","上傳成功",t.data),e.uploadModal=!1}))},onDelete:function(t){var e=this;this.$confirm(this.tableOptions["deleteMessage"]?this.tableOptions["deleteMessage"]:"確定刪除嗎？","確定刪除？",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("delete",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},onSubmit:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;t.editing?t.$emit("edit",{id:t.editID,data:t.formBody}):t.$emit("create",t.formBody)}))},onReset:function(){this.formBody=JSON.parse(JSON.stringify(this.editItem))},handleCurrentChange:function(t){this.tableOptions["isCanSelection"]&&this.$emit("select-row",t)},handlePageSizeChange:function(t){var e=this;this.$nextTick((function(){var n=Math.ceil(e.data["totalCount"]/t);e.page>n?(e.$emit("page-change",[e.target,n]),e.$emit("size-change",[e.target,t])):e.$emit("size-change",[e.target,t])}))},handlePageCurrentChange:function(t){var e=this;this.$nextTick((function(){e.$emit("page-change",[e.target,t])}))},formatRow:function(t,e){var n=e.split("."),i=n.reduce((function(t,e){return t[e]}),t);return i}}},k=w,_=(n("4efc"),Object(d["a"])(k,i,o,!1,null,null,null));e["a"]=_.exports},2095:function(t,e,n){"use strict";n("b963")},"24fe":function(t,e,n){"use strict";n("f9a6")},"4efc":function(t,e,n){"use strict";n("c5ac")},6464:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}));var i=n("5c96"),o=function(t,e,n,o){return Object(i["Notification"])({title:e,message:n,type:t,showClose:o})},a=function(t,e){return Object(i["Message"])({type:t,message:e})}},"7db0":function(t,e,n){"use strict";var i=n("23e7"),o=n("b727").find,a=n("44d2"),l=n("ae40"),s="find",r=!0,c=l(s);s in[]&&Array(1)[s]((function(){r=!1})),i({target:"Array",proto:!0,forced:r||!c},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a(s)},b963:function(t,e,n){},c5ac:function(t,e,n){},f9a6:function(t,e,n){}}]);